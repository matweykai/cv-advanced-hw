# Finger Tracking App - Домашнее задание по курсу "Продвинутый CV"

Данный проект представляет собой домашнее задание по курсу "Продвинутый компьютерный зрение". Приложение предназначено для отслеживания и визуализации движения пальца на видео с использованием различных методов компьютерного зрения.

**Ссылка на отчет:** [ССЫЛКА_НА_GOOGLE_DISK(https://docs.google.com/document/d/1Jy5xZxdl68zWbab3aPQXRoSQ1EOsTBBb328LXqb7P-8/edit?usp=sharing)] 

## Описание проекта

В рамках домашнего задания реализовано:
- Трекинг движения пальцев руки на видео
- Визуализация траектории движения
- Сравнение двух подходов: MediaPipe и собственной обученной модели

## Особенности

- Поддержка двух моделей:
  - **MediaPipe Hands** - быстрая и надежная модель от Google
  - **Нейронная сеть UNetResNet34** - обученная модель для задачи трекинга пальцев
- Выбор любого пальца для отслеживания
- Создание графика траектории движения пальца
- Интерактивный режим запуска с удобным меню
- Визуализация процесса в реальном времени

## Файлы проекта

- **pose_estimation_model.pth** - предобученная модель для распознавания ключевых точек руки (необходима для запуска в режиме custom)
- **FingerTracking_Experiments.ipynb** - Jupyter Notebook с экспериментами, обучением модели и подробным анализом результатов
- **interactive_run.py** - интерактивный скрипт для запуска приложения
- **run.py** - запуск через командную строку

## Установка

1. Клонируйте репозиторий:
```
git clone https://github.com/your-username/finger-tracking-app.git
cd finger-tracking-app
```

2. Установите зависимости:
```
pip install -r requirements.txt
```

3. Подготовьте данные:
   - Поместите видеофайлы в папку `test_video` (сейчас там лежат два тестовых видео)
   - Убедитесь, что файл `pose_estimation_model.pth` находится в корневой директории проекта

## Использование

### Интерактивный режим (рекомендуется)

```
python interactive_run.py
```

Следуйте инструкциям в интерактивном меню:
1. Выберите видеофайл из папки `test_video`
2. Выберите модель (MediaPipe или нейросеть)
3. Выберите палец для отслеживания
4. Дождитесь результата обработки

Результат будет автоматически сохранен в папку `result` и открыт для просмотра.

### Режим командной строки

```
python run.py --video test_video/your_video.mp4 --output result/trajectory.png --model-type mediapipe
```

Параметры командной строки:
- `--video` - путь к видеофайлу
- `--output` - путь для сохранения результата
- `--model-type` - тип модели (`mediapipe` или `custom`)
- `--model-path` - путь к файлу модели (для `--model-type=custom`)
- `--finger-index` - индекс отслеживаемого пальца (8 для указательного)
- `--show` - показывать процесс обработки в реальном времени

## Индексы пальцев

- **0**: Запястье
- **4**: Кончик большого пальца
- **8**: Кончик указательного пальца (по умолчанию)
- **12**: Кончик среднего пальца
- **16**: Кончик безымянного пальца
- **20**: Кончик мизинца

## Структура проекта

```
finger-tracking-app/
├── app/
│   ├── __init__.py
│   └── main.py          # Основной код обработки
├── models/
│   ├── __init__.py
│   ├── custom_model.py  # Модель UNetResNet34
│   └── mediapipe_model.py  # Интерфейс MediaPipe
├── test_video/          # Папка с видеофайлами
├── result/              # Папка для результатов
├── pose_estimation_model.pth  # Предобученная модель
├── FingerTracking_Experiments.ipynb  # Jupyter Notebook с экспериментами
├── requirements.txt     # Зависимости
├── README.md            # Документация
├── run.py               # Запуск через командную строку
└── interactive_run.py   # Интерактивный запуск
```

## Jupyter Notebook

В файле `FingerTracking_Experiments.ipynb` содержатся:
- Эксперименты по обучению модели
- Анализ данных и результатов
- Визуализация работы алгоритмов
- Сравнение различных подходов к трекингу
- Подробные пояснения к методологии

Для запуска ноутбука:
```
jupyter notebook FingerTracking_Experiments.ipynb
```

## Требования

- Python 3.7+
- PyTorch
- OpenCV
- MediaPipe
- NumPy
- Matplotlib
- Jupyter (для работы с ноутбуком)

## Примечания

- Для пользовательской модели необходим файл `pose_estimation_model.pth`
- Результаты сохраняются в папке `result` автоматически
- При ошибках с MediaPipe попробуйте обновить медиапайп до последней версии