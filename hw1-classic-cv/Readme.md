# Домашнее задание по Классическим алгоритмам CV

**Ссылка на отчет:** [ССЫЛКА_НА_GOOGLE_DISK](https://docs.google.com/document/d/1kwOGHur6AA_r10NQxNsL372f3xjoW3tVFTelRTKemJs/edit?tab=t.0)

Ноутбук с экспериментами `CV_basic_algorythms_1.ipynb`

Этот проект предоставляет инструменты для обнаружения дубликатов изображений и группировки похожих изображений с использованием двух методов:
1. **Классический метод**: Использует традиционные методы компьютерного зрения, включая SIFT дескрипторы, перцептивный хеширование и цветовые гистограммы
2. **ResNet метод**: Использует глубокое обучение для извлечения признаков из предобученной модели ResNet50



## Требования

- Python 3.8+
- Зависимости, перечисленные в `requirements.txt`

## Установка

1. Клонируйте этот репозиторий:
```bash
git clone https://github.com/yourusername/image-duplicate-detection.git
cd image-duplicate-detection
```

2. Установите необходимые зависимости:
```bash
pip install -r requirements.txt
```

## Использование

Основной скрипт можно запустить со следующими параметрами:

```bash
python -m src.main --method [classical|resnet] --task [match|group]
```

### Параметры:

- `--method`: Определяет метод, который нужно использовать:
  - `classical`: Использовать традиционные методы компьютерного зрения
  - `resnet`: Использовать глубокое обучение с ResNet50

- `--task`: Определяет задачу, которую нужно выполнить:
  - `match`: Найти дубликаты изображений между обучающей и тестовой директориями
  - `group`: Сгруппировать похожие изображения в кластеры

### Примеры:

Найти дубликаты изображений с использованием классического метода:
```bash
python -m src.main --method classical --task match
```

Сгруппировать похожие изображения с использованием ResNet метода:
```bash
python -m src.main --method resnet --task group
```

## Конфигурация

Пути к обучающей и тестовой директориям определены в `configs/config.yaml`:

```yaml
paths:
  train_dir: "/путь/к/вашей/директории/с/обучающими/изображениями"
  test_dir: "/путь/к/вашей/директории/с/тестовыми/изображениями"
```

Обновите эти пути, чтобы они указывали на ваши директории с изображениями перед запуском скрипта.

## Результаты

Результаты сохраняются в директории `result`:

- Для задачи `match`: CSV-файл, содержащий список дубликатов изображений
- Для задачи `group`: CSV-файл с именами файлов изображений и их назначением кластера

## Как это работает

### Классический метод

- **Сопоставление**: Использует комбинацию перцептивного хеширования, цветовых гистограмм и сопоставления SIFT-признаков с RANSAC для оценки гомографии
- **Группировка**: Использует ORB-дескрипторы и кластеризацию DBSCAN для группировки похожих изображений

### ResNet метод

- **Сопоставление**: Извлекает эмбеддинги признаков с помощью ResNet50 и сравнивает их, используя косинусную меру сходства
- **Группировка**: Использует признаки ResNet50 и кластеризацию на основе порогов для группировки похожих изображений

